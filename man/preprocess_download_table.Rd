% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils-export_table.R
\name{preprocess_download_table}
\alias{preprocess_download_table}
\title{Preprocess table for download as Excel (.xlsx) or Word (.rtf)}
\usage{
preprocess_download_table(count_table, download_type, split_columns)
}
\arguments{
\item{count_table}{A reactive list containing dataset containing the event data
and other metadata.}

\item{download_type}{A string specifying the download type as a file extension, either
\code{.xlsx} for Excel or \code{.rtf} for Word.}

\item{split_columns}{A logical indicating if count and percent should be split into separate
columns.}
}
\value{
Processed data frame.
}
\description{
Preprocess table for download as Excel (.xlsx) or Word (.rtf)
}
\details{
Each entry in the group columns of the \code{count_table} data frame is a 2-element list of \code{count}
(formatted as count and percent) and \code{subjid} - the count and percent information is extracted
into the processed data.

Overall patient numbers are extracted from the metadata and added as a separate line at the
beginning.

If the option to split count and percentage into separate columns is selected, then the column
with the count will be suffixed with \code{" [N]"} and the column with the percentage will be suffixed
with \code{" [\%]"}.

When processing data for Word, dual event columns are merged into an indented hierarchy of event
values.
}
\keyword{internal}
